}
p <- ggplot(l1,aes(x=x,y=value,group=get(group))) +
srn.chartsThemeLight()
# Chart Type
if(chartType=="bar"){
p <- p + geom_bar(aes(fill=get(class),color="black"), stat="identity",position=position) +
scale_fill_manual(values=paletteX) + guides(color=F)
if(!grepl("class",class)){
p = p + guides(fill = guide_legend(title=paste(class,sep="")))}else{
if(length(unique(l1[[classLabel]]))<2){
p = p + theme(legend.position="none")
}else{
p = p + guides(fill = guide_legend(title=unique(l1[[classLabel]])))
}
}
}
if(chartType=="line"){
p <- p +  geom_line(aes(color=get(class)), stat="identity",position="identity") +
scale_color_manual(values=paletteX)
if(!grepl("class",class)){
p = p + guides(color = guide_legend(title=paste(class,sep="")))}else{
if(length(unique(l1[[classLabel]]))<2){
p = p + theme(legend.position="none")
}else{
p = p + guides(color = guide_legend(title=unique(l1[[classLabel]])))
}
}
}
p <- p +
xlab(unique(l1[[xLabel]])) + ylab(eval(parse(text=paste(unique(l1[[units]]),collapse="~")))) +
theme(axis.text.x=element_text(angle=90,hjust=1,vjust=0.5)) +
scale_x_continuous (breaks=(seq(min(range(l1[[x]])),max(range(l1[[x]])),by=xBreaksMaj)),
minor_breaks=(seq(min(range(l1[[x]])),max(range(l1[[x]])),by=xBreaksMin)),
expand=c(0,xBreaksMaj/2)) +
scale_y_continuous(breaks = pretty_breaks(n = yBreaksMajn), minor_breaks = waiver())
# Faceting
if(length(unique(l1[[facet_columns]])) > 1 & length(unique(l1[[facet_rows]])) > 1){
p <- p + facet_grid(get(facet_rows)~get(facet_columns),scales=scales)
}else{
if(length(unique(l1[[facet_columns]])) > 1 & length(unique(l1[[facet_rows]])) == 0){
p <- p + facet_wrap(get(facet_columns)~.,ncol=ncolrow,scales = scales)
}
if(length(unique(l1[[facet_columns]])) == 0 & length(unique(l1[[facet_rows]])) > 1){
p <- p + facet_wrap(get(facet_rows)~.,nrow=ncolrow,scales = scales)
}
}
return(p)
}
srn.chartsBar(a1,"bar",facet_columns="scenario",position="dodge2")
srn.chartsBar<-function(srnFormattedTable,
chartType="bar",position="stack",
x="x",y="value",class="class1",group="scenario",
classPalette="classPalette1",classLabel="classLabel1",
xLabel="xLabel",
facet_rows="region",facet_columns="scenario",ncolrow=4,scales="fixed",
useNewLabels=1,units="units",
xBreaksMaj=10, xBreaksMin=5,
yBreaksMajn=5, yBreaksMinn=10){
l1 <- srnFormattedTable
l1[[units]] = gsub(" ","~",l1[[units]])
paletteX<-srn.colors()[[unique(l1[[classPalette]])]];
if(useNewLabels==1){
if(!is.null(names(paletteX))){
names(paletteX)<-toTitleCase(sub("\\b[a-zA-Z0-9]{1} \\b", "",names(paletteX)))}
l1[[class]]<-toTitleCase(sub("\\b[a-zA-Z0-9]{1} \\b", "",l1[[class]]))
}
p <- ggplot(l1,aes(x=x,y=value,group=get(group))) +
srn.chartsThemeLight()
# Chart Type
if(chartType=="bar"){
p <- p + geom_bar(aes(fill=get(class)),color="black", stat="identity",position=position) +
scale_fill_manual(values=paletteX) + guides(color=F)
if(!grepl("class",class)){
p = p + guides(fill = guide_legend(title=paste(class,sep="")))}else{
if(length(unique(l1[[classLabel]]))<2){
p = p + theme(legend.position="none")
}else{
p = p + guides(fill = guide_legend(title=unique(l1[[classLabel]])))
}
}
}
if(chartType=="line"){
p <- p +  geom_line(aes(color=get(class)), stat="identity",position="identity") +
scale_color_manual(values=paletteX)
if(!grepl("class",class)){
p = p + guides(color = guide_legend(title=paste(class,sep="")))}else{
if(length(unique(l1[[classLabel]]))<2){
p = p + theme(legend.position="none")
}else{
p = p + guides(color = guide_legend(title=unique(l1[[classLabel]])))
}
}
}
p <- p +
xlab(unique(l1[[xLabel]])) + ylab(eval(parse(text=paste(unique(l1[[units]]),collapse="~")))) +
theme(axis.text.x=element_text(angle=90,hjust=1,vjust=0.5)) +
scale_x_continuous (breaks=(seq(min(range(l1[[x]])),max(range(l1[[x]])),by=xBreaksMaj)),
minor_breaks=(seq(min(range(l1[[x]])),max(range(l1[[x]])),by=xBreaksMin)),
expand=c(0,xBreaksMaj/2)) +
scale_y_continuous(breaks = pretty_breaks(n = yBreaksMajn), minor_breaks = waiver())
# Faceting
if(length(unique(l1[[facet_columns]])) > 1 & length(unique(l1[[facet_rows]])) > 1){
p <- p + facet_grid(get(facet_rows)~get(facet_columns),scales=scales)
}else{
if(length(unique(l1[[facet_columns]])) > 1 & length(unique(l1[[facet_rows]])) == 0){
p <- p + facet_wrap(get(facet_columns)~.,ncol=ncolrow,scales = scales)
}
if(length(unique(l1[[facet_columns]])) == 0 & length(unique(l1[[facet_rows]])) > 1){
p <- p + facet_wrap(get(facet_rows)~.,nrow=ncolrow,scales = scales)
}
}
return(p)
}
srn.chartsBar(a1,"bar",facet_columns="scenario",position="dodge2")
srn.chartsBar<-function(srnFormattedTable,
chartType="bar",position="stack",
x="x",y="value",class="class1",group="scenario",
classPalette="classPalette1",classLabel="classLabel1",
xLabel="xLabel",
facet_rows="region",facet_columns="scenario",ncolrow=4,scales="fixed",
useNewLabels=1,units="units",
xBreaksMaj=10, xBreaksMin=5,
yBreaksMajn=5, yBreaksMinn=10){
l1 <- srnFormattedTable
l1[[units]] = gsub(" ","~",l1[[units]])
paletteX<-srn.colors()[[unique(l1[[classPalette]])]];
if(useNewLabels==1){
if(!is.null(names(paletteX))){
names(paletteX)<-toTitleCase(sub("\\b[a-zA-Z0-9]{1} \\b", "",names(paletteX)))}
l1[[class]]<-toTitleCase(sub("\\b[a-zA-Z0-9]{1} \\b", "",l1[[class]]))
}
p <- ggplot(l1,aes(x=x,y=value,group=get(group))) +
srn.chartsThemeLight()
# Chart Type
if(chartType=="bar"){
p <- p + geom_bar(aes(fill=get(class)),color="black", stat="identity",position=position) +
scale_fill_manual(values=paletteX) +  scale_color_manaual(size=3) + guides(color=F)
if(!grepl("class",class)){
p = p + guides(fill = guide_legend(title=paste(class,sep="")))}else{
if(length(unique(l1[[classLabel]]))<2){
p = p + theme(legend.position="none")
}else{
p = p + guides(fill = guide_legend(title=unique(l1[[classLabel]])))
}
}
}
if(chartType=="line"){
p <- p +  geom_line(aes(color=get(class)), stat="identity",position="identity") +
scale_color_manual(values=paletteX)
if(!grepl("class",class)){
p = p + guides(color = guide_legend(title=paste(class,sep="")))}else{
if(length(unique(l1[[classLabel]]))<2){
p = p + theme(legend.position="none")
}else{
p = p + guides(color = guide_legend(title=unique(l1[[classLabel]])))
}
}
}
p <- p +
xlab(unique(l1[[xLabel]])) + ylab(eval(parse(text=paste(unique(l1[[units]]),collapse="~")))) +
theme(axis.text.x=element_text(angle=90,hjust=1,vjust=0.5)) +
scale_x_continuous (breaks=(seq(min(range(l1[[x]])),max(range(l1[[x]])),by=xBreaksMaj)),
minor_breaks=(seq(min(range(l1[[x]])),max(range(l1[[x]])),by=xBreaksMin)),
expand=c(0,xBreaksMaj/2)) +
scale_y_continuous(breaks = pretty_breaks(n = yBreaksMajn), minor_breaks = waiver())
# Faceting
if(length(unique(l1[[facet_columns]])) > 1 & length(unique(l1[[facet_rows]])) > 1){
p <- p + facet_grid(get(facet_rows)~get(facet_columns),scales=scales)
}else{
if(length(unique(l1[[facet_columns]])) > 1 & length(unique(l1[[facet_rows]])) == 0){
p <- p + facet_wrap(get(facet_columns)~.,ncol=ncolrow,scales = scales)
}
if(length(unique(l1[[facet_columns]])) == 0 & length(unique(l1[[facet_rows]])) > 1){
p <- p + facet_wrap(get(facet_rows)~.,nrow=ncolrow,scales = scales)
}
}
return(p)
}
srn.chartsBar(a1,"bar",facet_columns="scenario",position="dodge2")
srn.chartsBar<-function(srnFormattedTable,
chartType="bar",position="stack",
x="x",y="value",class="class1",group="scenario",
classPalette="classPalette1",classLabel="classLabel1",
xLabel="xLabel",
facet_rows="region",facet_columns="scenario",ncolrow=4,scales="fixed",
useNewLabels=1,units="units",
xBreaksMaj=10, xBreaksMin=5,
yBreaksMajn=5, yBreaksMinn=10){
l1 <- srnFormattedTable
l1[[units]] = gsub(" ","~",l1[[units]])
paletteX<-srn.colors()[[unique(l1[[classPalette]])]];
if(useNewLabels==1){
if(!is.null(names(paletteX))){
names(paletteX)<-toTitleCase(sub("\\b[a-zA-Z0-9]{1} \\b", "",names(paletteX)))}
l1[[class]]<-toTitleCase(sub("\\b[a-zA-Z0-9]{1} \\b", "",l1[[class]]))
}
p <- ggplot(l1,aes(x=x,y=value,group=get(group))) +
srn.chartsThemeLight()
# Chart Type
if(chartType=="bar"){
p <- p + geom_bar(aes(fill=get(class)),color="black", stat="identity",position=position) +
scale_fill_manual(values=paletteX) + scale_color_manual(size=3) + guides(color=F)
if(!grepl("class",class)){
p = p + guides(fill = guide_legend(title=paste(class,sep="")))}else{
if(length(unique(l1[[classLabel]]))<2){
p = p + theme(legend.position="none")
}else{
p = p + guides(fill = guide_legend(title=unique(l1[[classLabel]])))
}
}
}
if(chartType=="line"){
p <- p +  geom_line(aes(color=get(class)), stat="identity",position="identity") +
scale_color_manual(values=paletteX)
if(!grepl("class",class)){
p = p + guides(color = guide_legend(title=paste(class,sep="")))}else{
if(length(unique(l1[[classLabel]]))<2){
p = p + theme(legend.position="none")
}else{
p = p + guides(color = guide_legend(title=unique(l1[[classLabel]])))
}
}
}
p <- p +
xlab(unique(l1[[xLabel]])) + ylab(eval(parse(text=paste(unique(l1[[units]]),collapse="~")))) +
theme(axis.text.x=element_text(angle=90,hjust=1,vjust=0.5)) +
scale_x_continuous (breaks=(seq(min(range(l1[[x]])),max(range(l1[[x]])),by=xBreaksMaj)),
minor_breaks=(seq(min(range(l1[[x]])),max(range(l1[[x]])),by=xBreaksMin)),
expand=c(0,xBreaksMaj/2)) +
scale_y_continuous(breaks = pretty_breaks(n = yBreaksMajn), minor_breaks = waiver())
# Faceting
if(length(unique(l1[[facet_columns]])) > 1 & length(unique(l1[[facet_rows]])) > 1){
p <- p + facet_grid(get(facet_rows)~get(facet_columns),scales=scales)
}else{
if(length(unique(l1[[facet_columns]])) > 1 & length(unique(l1[[facet_rows]])) == 0){
p <- p + facet_wrap(get(facet_columns)~.,ncol=ncolrow,scales = scales)
}
if(length(unique(l1[[facet_columns]])) == 0 & length(unique(l1[[facet_rows]])) > 1){
p <- p + facet_wrap(get(facet_rows)~.,nrow=ncolrow,scales = scales)
}
}
return(p)
}
srn.chartsBar(a1,"bar",facet_columns="scenario",position="dodge2")
srn.chartsBar<-function(srnFormattedTable,
chartType="bar",position="stack",
x="x",y="value",class="class1",group="scenario",
classPalette="classPalette1",classLabel="classLabel1",
xLabel="xLabel",
facet_rows="region",facet_columns="scenario",ncolrow=4,scales="fixed",
useNewLabels=1,units="units",
xBreaksMaj=10, xBreaksMin=5,
yBreaksMajn=5, yBreaksMinn=10){
l1 <- srnFormattedTable
l1[[units]] = gsub(" ","~",l1[[units]])
paletteX<-srn.colors()[[unique(l1[[classPalette]])]];
if(useNewLabels==1){
if(!is.null(names(paletteX))){
names(paletteX)<-toTitleCase(sub("\\b[a-zA-Z0-9]{1} \\b", "",names(paletteX)))}
l1[[class]]<-toTitleCase(sub("\\b[a-zA-Z0-9]{1} \\b", "",l1[[class]]))
}
p <- ggplot(l1,aes(x=x,y=value,group=get(group))) +
srn.chartsThemeLight()
# Chart Type
if(chartType=="bar"){
p <- p + geom_bar(aes(fill=get(class)),size=3,color="black", stat="identity",position=position) +
scale_fill_manual(values=paletteX) + guides(color=F)
if(!grepl("class",class)){
p = p + guides(fill = guide_legend(title=paste(class,sep="")))}else{
if(length(unique(l1[[classLabel]]))<2){
p = p + theme(legend.position="none")
}else{
p = p + guides(fill = guide_legend(title=unique(l1[[classLabel]])))
}
}
}
if(chartType=="line"){
p <- p +  geom_line(aes(color=get(class)), stat="identity",position="identity") +
scale_color_manual(values=paletteX)
if(!grepl("class",class)){
p = p + guides(color = guide_legend(title=paste(class,sep="")))}else{
if(length(unique(l1[[classLabel]]))<2){
p = p + theme(legend.position="none")
}else{
p = p + guides(color = guide_legend(title=unique(l1[[classLabel]])))
}
}
}
p <- p +
xlab(unique(l1[[xLabel]])) + ylab(eval(parse(text=paste(unique(l1[[units]]),collapse="~")))) +
theme(axis.text.x=element_text(angle=90,hjust=1,vjust=0.5)) +
scale_x_continuous (breaks=(seq(min(range(l1[[x]])),max(range(l1[[x]])),by=xBreaksMaj)),
minor_breaks=(seq(min(range(l1[[x]])),max(range(l1[[x]])),by=xBreaksMin)),
expand=c(0,xBreaksMaj/2)) +
scale_y_continuous(breaks = pretty_breaks(n = yBreaksMajn), minor_breaks = waiver())
# Faceting
if(length(unique(l1[[facet_columns]])) > 1 & length(unique(l1[[facet_rows]])) > 1){
p <- p + facet_grid(get(facet_rows)~get(facet_columns),scales=scales)
}else{
if(length(unique(l1[[facet_columns]])) > 1 & length(unique(l1[[facet_rows]])) == 0){
p <- p + facet_wrap(get(facet_columns)~.,ncol=ncolrow,scales = scales)
}
if(length(unique(l1[[facet_columns]])) == 0 & length(unique(l1[[facet_rows]])) > 1){
p <- p + facet_wrap(get(facet_rows)~.,nrow=ncolrow,scales = scales)
}
}
return(p)
}
srn.chartsBar(a1,"bar",facet_columns="scenario",position="dodge2")
srn.chartsBar<-function(srnFormattedTable,
chartType="bar",position="stack",
x="x",y="value",class="class1",group="scenario",
classPalette="classPalette1",classLabel="classLabel1",
xLabel="xLabel",
facet_rows="region",facet_columns="scenario",ncolrow=4,scales="fixed",
useNewLabels=1,units="units",
xBreaksMaj=10, xBreaksMin=5,
yBreaksMajn=5, yBreaksMinn=10,
sizeBarLines=0.5){
l1 <- srnFormattedTable
l1[[units]] = gsub(" ","~",l1[[units]])
paletteX<-srn.colors()[[unique(l1[[classPalette]])]];
if(useNewLabels==1){
if(!is.null(names(paletteX))){
names(paletteX)<-toTitleCase(sub("\\b[a-zA-Z0-9]{1} \\b", "",names(paletteX)))}
l1[[class]]<-toTitleCase(sub("\\b[a-zA-Z0-9]{1} \\b", "",l1[[class]]))
}
p <- ggplot(l1,aes(x=x,y=value,group=get(group))) +
srn.chartsThemeLight()
# Chart Type
if(chartType=="bar"){
p <- p + geom_bar(aes(fill=get(class)),size=sizeBarLines,color="black", stat="identity",position=position) +
scale_fill_manual(values=paletteX) + guides(color=F)
if(!grepl("class",class)){
p = p + guides(fill = guide_legend(title=paste(class,sep="")))}else{
if(length(unique(l1[[classLabel]]))<2){
p = p + theme(legend.position="none")
}else{
p = p + guides(fill = guide_legend(title=unique(l1[[classLabel]])))
}
}
}
if(chartType=="line"){
p <- p +  geom_line(aes(color=get(class)), stat="identity",position="identity") +
scale_color_manual(values=paletteX)
if(!grepl("class",class)){
p = p + guides(color = guide_legend(title=paste(class,sep="")))}else{
if(length(unique(l1[[classLabel]]))<2){
p = p + theme(legend.position="none")
}else{
p = p + guides(color = guide_legend(title=unique(l1[[classLabel]])))
}
}
}
p <- p +
xlab(unique(l1[[xLabel]])) + ylab(eval(parse(text=paste(unique(l1[[units]]),collapse="~")))) +
theme(axis.text.x=element_text(angle=90,hjust=1,vjust=0.5)) +
scale_x_continuous (breaks=(seq(min(range(l1[[x]])),max(range(l1[[x]])),by=xBreaksMaj)),
minor_breaks=(seq(min(range(l1[[x]])),max(range(l1[[x]])),by=xBreaksMin)),
expand=c(0,xBreaksMaj/2)) +
scale_y_continuous(breaks = pretty_breaks(n = yBreaksMajn), minor_breaks = waiver())
# Faceting
if(length(unique(l1[[facet_columns]])) > 1 & length(unique(l1[[facet_rows]])) > 1){
p <- p + facet_grid(get(facet_rows)~get(facet_columns),scales=scales)
}else{
if(length(unique(l1[[facet_columns]])) > 1 & length(unique(l1[[facet_rows]])) == 0){
p <- p + facet_wrap(get(facet_columns)~.,ncol=ncolrow,scales = scales)
}
if(length(unique(l1[[facet_columns]])) == 0 & length(unique(l1[[facet_rows]])) > 1){
p <- p + facet_wrap(get(facet_rows)~.,nrow=ncolrow,scales = scales)
}
}
return(p)
}
srn.chartsBar(a1,"bar",facet_columns="scenario",position="dodge2")
srn.chartsBar(a1,"bar",facet_columns="scenario",position="dodge2",class="scenario")
srn.chartsBar(a1,"bar",facet_columns="scenario",position="dodge2",class="scenario",facet_rows="none",facet_columns="region")
srn.chartsBar(a1,"bar",facet_columns="region",position="dodge2",class="scenario",facet_rows="none")
srn.chartsBar(a1,"line",facet_columns="region",position="dodge2",class="scenario",facet_rows="none")
srn.chart<-function(srnFormattedTable,
chartType="bar",position="stack",
x="x",y="value",class="class1",group="scenario",
classPalette="classPalette1",classLabel="classLabel1",
xLabel="xLabel",
facet_rows="region",facet_columns="scenario",ncolrow=4,scales="fixed",
useNewLabels=1,units="units",
xBreaksMaj=10, xBreaksMin=5,
yBreaksMajn=5, yBreaksMinn=10,
sizeBarLines=0.5,sizeLines=1.5){
l1 <- srnFormattedTable
l1[[units]] = gsub(" ","~",l1[[units]])
paletteX<-srn.colors()[[unique(l1[[classPalette]])]];
if(useNewLabels==1){
if(!is.null(names(paletteX))){
names(paletteX)<-toTitleCase(sub("\\b[a-zA-Z0-9]{1} \\b", "",names(paletteX)))}
l1[[class]]<-toTitleCase(sub("\\b[a-zA-Z0-9]{1} \\b", "",l1[[class]]))
}
p <- ggplot(l1,aes(x=x,y=value,group=get(group))) +
srn.chartsThemeLight()
# Chart Type
if(chartType=="bar"){
p <- p + geom_bar(aes(fill=get(class)),size=sizeBarLines,color="black", stat="identity",position=position) +
scale_fill_manual(values=paletteX) + guides(color=F)
if(!grepl("class",class)){
p = p + guides(fill = guide_legend(title=paste(class,sep="")))}else{
if(length(unique(l1[[classLabel]]))<2){
p = p + theme(legend.position="none")
}else{
p = p + guides(fill = guide_legend(title=unique(l1[[classLabel]])))
}
}
}
if(chartType=="line"){
p <- p +  geom_line(aes(color=get(class)),size=sizeLines, stat="identity",position="identity") +
scale_color_manual(values=paletteX)
if(!grepl("class",class)){
p = p + guides(color = guide_legend(title=paste(class,sep="")))}else{
if(length(unique(l1[[classLabel]]))<2){
p = p + theme(legend.position="none")
}else{
p = p + guides(color = guide_legend(title=unique(l1[[classLabel]])))
}
}
}
p <- p +
xlab(unique(l1[[xLabel]])) + ylab(eval(parse(text=paste(unique(l1[[units]]),collapse="~")))) +
theme(axis.text.x=element_text(angle=90,hjust=1,vjust=0.5)) +
scale_x_continuous (breaks=(seq(min(range(l1[[x]])),max(range(l1[[x]])),by=xBreaksMaj)),
minor_breaks=(seq(min(range(l1[[x]])),max(range(l1[[x]])),by=xBreaksMin)),
expand=c(0,xBreaksMaj/2)) +
scale_y_continuous(breaks = pretty_breaks(n = yBreaksMajn), minor_breaks = waiver())
# Faceting
if(length(unique(l1[[facet_columns]])) > 1 & length(unique(l1[[facet_rows]])) > 1){
p <- p + facet_grid(get(facet_rows)~get(facet_columns),scales=scales)
}else{
if(length(unique(l1[[facet_columns]])) > 1 & length(unique(l1[[facet_rows]])) == 0){
p <- p + facet_wrap(get(facet_columns)~.,ncol=ncolrow,scales = scales)
}
if(length(unique(l1[[facet_columns]])) == 0 & length(unique(l1[[facet_rows]])) > 1){
p <- p + facet_wrap(get(facet_rows)~.,nrow=ncolrow,scales = scales)
}
}
return(p)
}
srn.chart(a1,"line",facet_columns="region",position="dodge2",class="scenario",facet_rows="none")
srn.chart<-function(srnFormattedTable,
chartType="bar",position="stack",
x="x",y="value",class="class1",group="scenario",
classPalette="classPalette1",classLabel="classLabel1",
xLabel="xLabel",
facet_rows="region",facet_columns="scenario",ncolrow=4,scales="fixed",
useNewLabels=1,units="units",
xBreaksMaj=10, xBreaksMin=5,
yBreaksMajn=5, yBreaksMinn=10,
sizeBarLines=0.5,sizeLines=1.5){
l1 <- srnFormattedTable
l1[[units]] = gsub(" ","~",l1[[units]])
paletteX<-srn.colors()[[unique(l1[[classPalette]])]];
if(useNewLabels==1){
if(!is.null(names(paletteX))){
names(paletteX)<-toTitleCase(sub("\\b[a-zA-Z0-9]{1} \\b", "",names(paletteX)))}
l1[[class]]<-toTitleCase(sub("\\b[a-zA-Z0-9]{1} \\b", "",l1[[class]]))
}
p <- ggplot(l1,aes(x=x,y=value,group=get(group))) +
srn.chartsThemeLight()
# Chart Type
if(chartType=="bar"){
p <- p + geom_bar(aes(fill=get(class)),size=sizeBarLines,color="black", stat="identity",position=position) +
scale_fill_manual(values=paletteX) + guides(color=F)
if(!grepl("class",class)){
p = p + guides(fill = guide_legend(title=toTitleCase(paste(class,sep=""))))}else{
if(length(unique(l1[[classLabel]]))<2){
p = p + theme(legend.position="none")
}else{
p = p + guides(fill = guide_legend(title=unique(l1[[classLabel]])))
}
}
}
if(chartType=="line"){
p <- p +  geom_line(aes(color=get(class)),size=sizeLines, stat="identity",position="identity") +
scale_color_manual(values=paletteX)
if(!grepl("class",class)){
p = p + guides(color = guide_legend(title=toTitleCase(paste(class,sep=""))))}else{
if(length(unique(l1[[classLabel]]))<2){
p = p + theme(legend.position="none")
}else{
p = p + guides(color = guide_legend(title=unique(l1[[classLabel]])))
}
}
}
p <- p +
xlab(unique(l1[[xLabel]])) + ylab(eval(parse(text=paste(unique(l1[[units]]),collapse="~")))) +
theme(axis.text.x=element_text(angle=90,hjust=1,vjust=0.5)) +
scale_x_continuous (breaks=(seq(min(range(l1[[x]])),max(range(l1[[x]])),by=xBreaksMaj)),
minor_breaks=(seq(min(range(l1[[x]])),max(range(l1[[x]])),by=xBreaksMin)),
expand=c(0,xBreaksMaj/2)) +
scale_y_continuous(breaks = pretty_breaks(n = yBreaksMajn), minor_breaks = waiver())
# Faceting
if(length(unique(l1[[facet_columns]])) > 1 & length(unique(l1[[facet_rows]])) > 1){
p <- p + facet_grid(get(facet_rows)~get(facet_columns),scales=scales)
}else{
if(length(unique(l1[[facet_columns]])) > 1 & length(unique(l1[[facet_rows]])) == 0){
p <- p + facet_wrap(get(facet_columns)~.,ncol=ncolrow,scales = scales)
}
if(length(unique(l1[[facet_columns]])) == 0 & length(unique(l1[[facet_rows]])) > 1){
p <- p + facet_wrap(get(facet_rows)~.,nrow=ncolrow,scales = scales)
}
}
return(p)
}
srn.chart(a1,"line",facet_columns="region",position="dodge2",class="scenario",facet_rows="none")
srn.chart(a1,"line",facet_columns="scenario",position="dodge2",class="region",facet_rows="none")
